(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{12:function(e,s,n){},13:function(e,s,n){},14:function(e,s,n){"use strict";n.r(s);var t=n(0),r=n(1),c=n.n(r),a=n(5),i=n.n(a),o=(n(12),n(3)),u=n(2),j=(n(13),function(e){var s=e.user,n=e.onLogout;return s.isLoggedIn?Object(t.jsx)("nav",{children:Object(t.jsx)("ul",{className:"nav",children:Object(t.jsx)("li",{children:Object(t.jsx)("a",{href:"#logout",onClick:n,children:"Logout"})})})}):null}),d=function(e){var s=e.currentUser,n=e.messages;return Object(t.jsx)("ol",{className:"messages",children:n.map((function(e){return Object(t.jsx)("li",{children:Object(t.jsxs)("div",{className:e.sender===s?"message self":"message",children:[Object(t.jsxs)("div",{className:"sender-info",children:[Object(t.jsx)("span",{className:"sendername",children:e.sender===s?s+"(You)":e.sender}),Object(t.jsx)("hr",{}),Object(t.jsx)("span",{className:"sendtime",children:(n=e.timestamp,new Date(Date.parse(n)).toString())})]}),Object(t.jsx)("p",{children:e.text})]})},e.id);var n}))})},l=function(e){var s=e.currentUser,n=e.users;return Object(t.jsx)("ul",{className:"users",children:n.map((function(e,n){return Object(t.jsx)("li",{children:Object(t.jsx)("div",{className:s===e?"user self":"user",children:Object(t.jsx)("span",{className:"sendername",children:s===e?e+"(You)":e})})},e+n)}))})},h=function(e){e.username;var s=e.onAddMessage,n=Object(r.useState)(""),c=Object(u.a)(n,2),a=c[0],i=c[1],o=Object(r.useState)(!1),j=Object(u.a)(o,2),d=j[0],l=j[1],h=Object(r.useState)(!0),m=Object(u.a)(h,2),b=m[0],g=m[1];return Object(t.jsx)("div",{className:"addmessage",children:Object(t.jsxs)("form",{children:[Object(t.jsx)("input",{onChange:function(e){i(e.target.value),g(!e.target.value)},className:"messagetosend",name:"text",value:a,placeholder:"Type your message"}),Object(t.jsx)("button",{onClick:function(){l(!0),function(e){return fetch("/api/message",{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({message:e})}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))}(a).then((function(e){s(e),i(""),l(!1),g(!0)}))},className:"sendbutton",type:"submit",disabled:d||b,children:"Send"})]})})},m=function(e){var s=e.currentUser,n=e.users,r=e.messages,c=e.onAddMessage;return Object(t.jsxs)("div",{className:"chat-app",children:[Object(t.jsxs)("div",{className:"display-panel",children:[Object(t.jsx)(d,{messages:r,currentUser:s}),Object(t.jsx)(l,{users:n,currentUser:s})]}),Object(t.jsx)(h,{onAddMessage:c})]})},b=n(6),g=n.n(b),O=function(e){var s=e.onLogin,n=Object(r.useState)(""),c=Object(u.a)(n,2),a=c[0],i=c[1],o=Object(r.useState)(!1),j=Object(u.a)(o,2),d=j[0],l=j[1],h=Object(r.useState)(!0),m=Object(u.a)(h,2),b=m[0],O=m[1],f=Object(r.useState)(""),p=Object(u.a)(f,2),x=p[0],v=p[1];return Object(t.jsxs)("div",{className:"login-screen",children:[Object(t.jsx)("h2",{children:"Login"}),Object(t.jsxs)("form",{children:[Object(t.jsxs)("div",{className:"login-box",children:[Object(t.jsx)("input",{onChange:function(e){v(""),i(e.target.value),O(!e.target.value)},className:"username-input",placeholder:"Type in your username",disabled:d,value:a}),Object(t.jsx)("br",{}),Object(t.jsx)("button",{onClick:function(){l(!0),function(e){var s=e.username;return fetch("/api/session",{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({username:s})}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))}({username:a}).then((function(e){var n=e.currentUser,t=e.users,r=e.messages;s({currentUser:n,users:t,messages:r}),v(""),l(!1)})).catch((function(e){v(e.error),l(!1)}))},className:"login-button",disabled:b||d,children:d?"...":"Login"})]}),Object(t.jsx)("div",{className:"status",children:g.a[x]})]})]})};var f=function(){var e,s=Object(r.useState)({isLoggedIn:!1,isPending:!0}),n=Object(u.a)(s,2),c=n[0],a=n[1];return Object(r.useEffect)((function(){fetch("/api/session",{method:"GET"}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})).then((function(e){var s=e.currentUser,n=e.users,t=e.messages;a({isLoggedIn:!0,isPending:!1,currentUser:s,users:n,messages:t})})).catch((function(){a({isLoggedIn:!1,isPending:!1})}))}),[]),Object(r.useEffect)((function(){!function e(){fetch("/api/messagesandusers",{method:"GET"}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})).then((function(e){var s=e.currentUser,n=e.users,t=e.messages;a({isLoggedIn:!0,isPending:!1,currentUser:s,users:n,messages:t})})).then(setTimeout(e,5e3))}()}),[]),c.isPending?Object(t.jsx)("div",{className:"app",children:"Loading..."}):(e=c.isLoggedIn?Object(t.jsx)(m,{currentUser:c.currentUser,users:c.users,messages:c.messages,onAddMessage:function(e){var s=c.messages;s.push(e),a(Object(o.a)(Object(o.a)({},c),{},{messages:s}))}}):Object(t.jsx)(O,{onLogin:function(e){var s=e.currentUser,n=e.users,t=e.messages;a({isLoggedIn:!0,isPending:!1,currentUser:s,users:n,messages:t})}}),Object(t.jsxs)("div",{className:"app",children:[Object(t.jsx)("div",{className:"app-title",children:Object(t.jsx)("h1",{children:"Chat App"})}),Object(t.jsx)(j,{user:c,onLogout:function(){a(Object(o.a)(Object(o.a)({},c),{},{isPending:!0})),fetch("/api/session",{method:"DELETE"}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})).then((function(){a({isLoggedIn:!1,isPending:!1})})).catch((function(){a(Object(o.a)(Object(o.a)({},c),{},{isPending:!1}))}))}}),e]}))},p=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,15)).then((function(s){var n=s.getCLS,t=s.getFID,r=s.getFCP,c=s.getLCP,a=s.getTTFB;n(e),t(e),r(e),c(e),a(e)}))};i.a.render(Object(t.jsx)(c.a.StrictMode,{children:Object(t.jsx)(f,{})}),document.getElementById("root")),p()},6:function(e,s){e.exports={"username-invalid":"Username is invalid, it should not contain dog!","username-required":"Username is required.","session-required":"","session-invalid":"Unknown user session."}}},[[14,1,2]]]);
//# sourceMappingURL=main.5d338a51.chunk.js.map